import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as u}from"./index.WFquGv8Z.js";import{a as w}from"./music.CRsQeu5U.js";const h=({line:s})=>{if(!s)return e.jsx("div",{className:"h-8"});const i=s.split(/(\[.*?\])/);return e.jsx("div",{className:"relative font-mono text-lg whitespace-pre-wrap leading-10",children:i.map((a,r)=>{const c=a.match(/^\[(.*?)\]$/);return c?e.jsx("span",{className:"inline-block relative w-0 overflow-visible align-baseline",children:e.jsx("span",{className:"absolute bottom-[1.2em] left-0 -translate-x-1/2 text-accent-main font-bold text-sm select-none whitespace-nowrap",children:c[1]})},r):e.jsx("span",{className:"text-text-main",children:a},r)})})};function C({initialContent:s,initialKey:i="C"}){const[a,r]=u.useState(s),[c,b]=u.useState(i);return u.useEffect(()=>{const l=(t,m)=>{const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],x={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#",Cb:"B",Fb:"E","E#":"F","B#":"C"}[t]||t;let f=n.indexOf(x);if(f===-1)return t;let d=(f+m)%12;return d<0&&(d+=12),n[d]},o=t=>{const m=t.detail.semitones;b(n=>{const p=l(n,m);return r(x=>w(x,n,p)),p})};return window.addEventListener("song-transpose",o),()=>window.removeEventListener("song-transpose",o)},[]),e.jsx("div",{className:"pb-20",children:a.split(`
`).map((l,o)=>e.jsx(h,{line:l},o))})}export{C as default};
