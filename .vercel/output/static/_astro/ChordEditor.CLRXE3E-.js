import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.WFquGv8Z.js";import{a as g,t as w}from"./music.CRsQeu5U.js";function N({name:i="content",initialContent:d=""}){const[s,r]=c.useState(d),[a,p]=c.useState("C"),x=c.useRef(null),u=["C","D","E","F","G","A","B","Cm","Dm","Em","Am","Bm"];c.useEffect(()=>{const t=n=>{const o=n.detail.key;r(l=>g(l,a,o)),p(o)};return window.addEventListener("song-key-change",t),()=>window.removeEventListener("song-key-change",t)},[a]);const b=t=>{const n=x.current;if(!n)return;const o=n.selectionStart,l=n.selectionEnd,h=n.value,f=h.substring(0,o)+`[${t}]`+h.substring(l);r(f),setTimeout(()=>{n.focus(),n.setSelectionRange(o+t.length+2,o+t.length+2)},0)},m=t=>{const n=s.replace(/\[(.*?)\]/g,(o,l)=>`[${w(l,t)}]`);r(n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"hidden",name:i,value:s}),e.jsxs("div",{className:"flex flex-wrap gap-2 p-2 bg-white/5 rounded-lg border border-white/10 items-center",children:[e.jsxs("div",{className:"flex gap-1 mr-4 border-r border-white/10 pr-4",children:[e.jsx("button",{type:"button",onClick:()=>m(-1),className:"px-3 py-1 text-sm font-bold text-white bg-red-500/80 hover:bg-red-600 rounded transition-colors",title:"Bajar 1 semitono",children:"-1 Tono"}),e.jsx("button",{type:"button",onClick:()=>m(1),className:"px-3 py-1 text-sm font-bold text-white bg-green-500/80 hover:bg-green-600 rounded transition-colors",title:"Subir 1 semitono",children:"+1 Tono"})]}),e.jsx("span",{className:"text-xs text-white/50 flex items-center mr-2",children:"Insertar:"}),u.map(t=>e.jsx("button",{type:"button",onClick:()=>b(t),className:"px-3 py-1 text-sm font-bold text-text-main bg-bg-secondary hover:bg-accent-main hover:text-white border border-white/10 rounded transition-colors",children:t},t))]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col h-[400px] lg:h-[500px]",children:[e.jsx("label",{className:"text-sm font-medium text-text-secondary mb-2",children:"Editor (Código)"}),e.jsx("textarea",{ref:x,value:s,onChange:t=>r(t.target.value),className:"w-full flex-1 bg-bg-secondary border border-white/10 rounded-lg p-4 font-mono text-sm text-text-main focus:outline-none focus:border-accent-main resize-none placeholder-white/20",placeholder:`Escribe la letra aquí y presiona los botones de acordes para insertar...
Ejemplo: Dios es[C]ta aqui`})]}),e.jsxs("div",{className:"flex flex-col h-[400px] lg:h-[500px]",children:[e.jsx("label",{className:"text-sm font-medium text-text-secondary mb-2",children:"Vista Previa (En vivo)"}),e.jsx("div",{className:"w-full flex-1 bg-[#fffbf6] text-gray-900 border border-white/10 rounded-lg p-6 overflow-y-auto shadow-inner",children:s.split(`
`).map((t,n)=>e.jsx(v,{line:t},n))})]})]})]})}const v=({line:i})=>{if(!i)return e.jsx("div",{className:"h-8"});const d=i.split(/(\[.*?\])/);return e.jsx("div",{className:"relative font-mono text-lg whitespace-pre-wrap leading-[3.5rem]",children:d.map((s,r)=>{const a=s.match(/^\[(.*?)\]$/);return a?e.jsx("span",{className:"inline-block relative w-0 overflow-visible align-baseline",children:e.jsx("span",{className:"absolute bottom-[1.2em] left-0 -translate-x-1/2 text-red-600 font-bold text-sm select-none whitespace-nowrap",children:a[1]})},r):e.jsx("span",{children:s},r)})})};export{N as default};
