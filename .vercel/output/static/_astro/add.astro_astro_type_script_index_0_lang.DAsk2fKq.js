import{c as u}from"./misas.DRDL5bBN.js";import{c as a,s as w}from"./alerts.CXiBSr95.js";import"./songs.Cv0urTgp.js";import"./sweetalert2.esm.all.BbQndx0i.js";const r=document.getElementById("addMisaForm"),e=r?.querySelector("button[type='submit']");r?.addEventListener("submit",async m=>{m.preventDefault();const o=new FormData(r),s=o.get("title"),n=o.get("dateMisa"),c=o.get("visibility"),i=r.getAttribute("data-token");if(console.log("add.astro - Form submitted",{title:s,dateMisa:n,visibility:c,token:i?"FOUND":"MISSING"}),!i){console.error("add.astro - Token missing in form attribute data-token"),await a("Error","No estás autenticado. Por favor inicia sesión."),window.location.href="/login";return}const l=e.innerText;e.disabled=!0,e.innerHTML=`
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Creando...
        `;try{console.log("add.astro - calling createMisa service");const{success:t,error:d}=await u(s,n,c,i);t?(await w("Misa creada correctamente"),window.location.href="/misas"):(console.error("Service error:",d),a("Error",d||"Error al crear la misa"),e.disabled=!1,e.innerText=l)}catch(t){console.error("Client exception:",t),a("Error","Ocurrió un error inesperado "+t),e.disabled=!1,e.innerText=l}});
