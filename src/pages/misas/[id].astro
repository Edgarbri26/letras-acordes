---
// export const prerender = false;
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import { getMisas } from "../../services/misas";
import { getMoments } from "@/services/moments";
import MisaSongManager from "@/components/MisaSongManager";
import type { Moment } from "@/types/misa";

const { id } = Astro.params;
const API_URL = import.meta.env.PUBLIC_API_URL || "http://localhost:3000/api";

let misa = null;
let error = null;
let moments: Moment[] = [];
let token = Astro.cookies.get("token")?.value;
let editToken = Astro.url.searchParams.get("edit_token");

if (id) {
    try {
        const headers: HeadersInit = {};
        if (token) headers["Authorization"] = `Bearer ${token}`;

        // Check for share token in query params (client-side nav might pass it, but server-side initial load relies on cookies or URL param)
        const url = new URL(`${API_URL}/misas/${id}`);
        // If there's a token query param in the current URL, pass it to the API
        const shareToken = Astro.url.searchParams.get("share_token");
        if (shareToken) url.searchParams.append("share_token", shareToken);

        if (editToken) url.searchParams.append("edit_token", editToken);

        const [misaRes, momentsRes] = await Promise.all([
            fetch(url.toString(), { headers }),
            getMoments(),
        ]);

        if (misaRes.ok) {
            misa = await misaRes.json();
            // Fallback: If backend is stale (missing canEdit), trust isOwner.
            misa.canEdit = misa.canEdit || misa.isOwner;
        } else {
            error = "No se encontr√≥ la misa.";
        }

        if (momentsRes.success && momentsRes.data) {
            moments = momentsRes.data;
        }
    } catch (e) {
        error = "Error de conexi√≥n.";
    }
}

// Helper to format date
const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleDateString("es-ES", {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
    });
};
---

<Layout
    title={misa ? `${misa.title} - CancioneroDigital` : "Misa no encontrada"}
>
    <main
        class="max-w-4xl mx-auto px-4 pt-8 sm:px-8"
        data-token={token}
        data-edit-token={editToken}
    >
        {
            error ? (
                <div class="text-center py-10">
                    <p class="text-red-500 font-bold text-xl">{error}</p>
                    <a
                        href="/misas"
                        class="text-blue-500 hover:underline mt-4 block"
                    >
                        Volver a Misas
                    </a>
                </div>
            ) : misa ? (
                <div>
                    <div class="mb-6 border-b border-gray-200 dark:border-gray-700 pb-4 ">
                        <div class="flex justify-between flex-col sm:flex-row sm:items-start items-center ">
                            <div>
                                <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-100">
                                    {misa.title}
                                </h1>
                                <p class="text-gray-600 dark:text-gray-400 mt-1 capitalize">
                                    üìÖ {formatDate(misa.dateMisa)}
                                </p>
                            </div>
                            <div class="flex gap-2">
                                {misa.visibility === "PRIVATE" &&
                                    (misa.isOwner ||
                                        token ||
                                        Astro.url.searchParams.get(
                                            "share_token",
                                        )) && (
                                        <button
                                            id="copyShareLinkBtn"
                                            data-share-token={misa.shareToken}
                                            class="text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 px-3 py-1 rounded hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors flex items-center gap-1"
                                        >
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="12"
                                                height="12"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                                            </svg>
                                            Link
                                        </button>
                                    )}
                                {misa.isOwner && (
                                    <button
                                        id="copyEditorLinkBtn"
                                        data-edit-token={misa.editToken}
                                        class="text-xs bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 px-3 py-1 rounded hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors flex items-center gap-1"
                                    >
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="12"
                                            height="12"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        >
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                        </svg>
                                        Link Editor
                                    </button>
                                )}
                                <a
                                    href={`/misas/view/${misa.id}${Astro.url.search}`}
                                    class="text-xs bg-accent-main/10 text-accent-main px-3 py-1 rounded hover:bg-accent-main/20 transition-colors flex items-center gap-1"
                                    title="Modo Lectura"
                                >
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        width="12"
                                        height="12"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="2"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        class="lucide lucide-book-open"
                                    >
                                        <>
                                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                                        </>
                                    </svg>
                                    Lectura
                                </a>
                                {misa.canEdit && (
                                    <button
                                        id="editMisaBtn"
                                        class="text-xs bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded hover:bg-gray-300 transition-colors"
                                    >
                                        Editar Info
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        {moments.map((moment) => {
                            const momentSongs = misa.misaSongs.filter(
                                (ms: any) => ms.momentId === moment.id,
                            );

                            return (
                                <div class="flex flex-col gap-2">
                                    <div class="flex flex-col sm:flex-row sm:items-center justify-start gap-2 sm:gap-4 border-b border-white/5 pb-2 last:border-0">
                                        <h2 class="text-xl font-bold sm:w-32 flex-shrink-0 flex items-center gap-2">
                                            {moment.nombre}:
                                            {misa.isOwner && (
                                                <button
                                                    data-moment-id={moment.id}
                                                    class="sm:hidden add-song-btn text-xs h-6 w-6 bg-accent-main text-white font-bold rounded hover:saturate-200 transition-transform transform active:scale-95 flex items-center justify-center"
                                                    title="Agregar canci√≥n"
                                                >
                                                    <i class="fa-solid fa-plus" />
                                                </button>
                                            )}
                                        </h2>

                                        <div class="flex flex-wrap items-center gap-2">
                                            {momentSongs.map((ms: any) => (
                                                <div class="flex items-center gap-1 group">
                                                    <a
                                                        href={`/songs/${ms.song.id}?tone=${encodeURIComponent(ms.key || ms.song.key)}`}
                                                        class="text-sm text-white bg-accent-main/30 border-2 border-accent-main
                                                        rounded-full px-4 py-2 text-center font-medium hover:text-white hover:bg-accent-main transition flex items-center gap-2"
                                                    >
                                                        <span class="text-center">
                                                            {ms.song.title}
                                                        </span>
                                                        {token ||
                                                        misa.canEdit ? (
                                                            <button
                                                                data-action="edit-tone"
                                                                data-misa-id={
                                                                    misa.id
                                                                }
                                                                data-misa-song-id={
                                                                    ms.id
                                                                }
                                                                data-current-tone={
                                                                    ms.key ||
                                                                    ms.song.key
                                                                }
                                                                class="text-xs font-bold text-accent-main bg-white/20 px-1.5 py-0.5 rounded hover:bg-white/40 transition-colors"
                                                                title="Cambiar tono"
                                                                onclick="event.preventDefault()"
                                                            >
                                                                {ms.key ||
                                                                    ms.song.key}
                                                            </button>
                                                        ) : (
                                                            <span class="text-xs font-bold text-accent-main bg-white/20 px-1.5 py-0.5 rounded">
                                                                {ms.key ||
                                                                    ms.song.key}
                                                            </span>
                                                        )}
                                                    </a>
                                                    <div class="flex items-center gap-1 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity">
                                                        {misa.canEdit && (
                                                            <a
                                                                href={`/edit-song/${ms.song.id}`}
                                                                class="text-gray-400 hover:text-accent-main p-1 transition-colors"
                                                                title="Editar canci√≥n"
                                                            >
                                                                <i class="fa-solid fa-pen-to-square w-4 h-4 flex items-center justify-center" />
                                                            </a>
                                                        )}
                                                        {(token ||
                                                            misa.canEdit) && (
                                                            <button
                                                                data-action="delete-song"
                                                                data-misa-id={
                                                                    misa.id
                                                                }
                                                                data-misa-song-id={
                                                                    ms.id
                                                                }
                                                                class="text-gray-400 hover:text-red-500 p-1 transition-colors"
                                                                title="Eliminar canci√≥n"
                                                            >
                                                                <i class="fa-solid fa-trash w-4 h-4 flex items-center justify-center" />
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}

                                            {misa.isOwner && (
                                                <button
                                                    data-moment-id={moment.id}
                                                    class="hidden sm:block add-song-btn text-sm h-10 w-10 bg-accent-main text-white font-bold rounded-lg hover:saturate-200 transition-transform transform active:scale-95 flex items-center justify-center"
                                                    title="Agregar canci√≥n"
                                                >
                                                    <i class="fa-solid fa-plus" />
                                                </button>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    <div class="mt-8 flex justify-between">
                        <a
                            href="/misas"
                            class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition"
                        >
                            ‚Üê Volver al listado
                        </a>
                        {/* Aqui podriamos poner un boton para Editar Misa o Agregar Canciones */}
                    </div>

                    {misa.canEdit ? (
                        <MisaSongManager
                            client:load
                            misaId={misa.id}
                            moments={moments}
                            token={token}
                            editToken={editToken}
                        />
                    ) : (
                        <div class="mt-8 text-center p-6 bg-gray-50 dark:bg-gray-800 rounded-xl border border-dashed border-gray-300 dark:border-gray-700">
                            <p class="text-gray-600 dark:text-gray-400 mb-4">
                                Inicia sesi√≥n para agregar canciones y editar la
                                misa.
                            </p>
                            <a
                                href="/login"
                                class="inline-block bg-accent-main text-white font-medium px-6 py-2 rounded-lg hover:bg-accent-main/90 transition-colors"
                            >
                                Iniciar Sesi√≥n
                            </a>
                        </div>
                    )}
                </div>
            ) : (
                <div class="text-center py-10">
                    <p class="text-gray-500">Cargando...</p>
                </div>
            )
        }
    </main>
</Layout>

<script>
    import {
        removeSongFromMisa,
        updateMisa,
        deleteMisa,
        updateMisaSong,
    } from "../../services/misas";
    import {
        showError,
        showSuccessToast,
        showConfirm,
        showLoading,
    } from "@/utils/alerts";

    import Swal from "sweetalert2";

    document.addEventListener("DOMContentLoaded", () => {
        // Edit Tone Logic
        const editToneBtns = document.querySelectorAll(
            'button[data-action="edit-tone"]',
        );
        editToneBtns.forEach((btn) => {
            btn.addEventListener("click", async (e) => {
                e.preventDefault();
                e.stopPropagation(); // Prevent navigation from parent anchor

                const currentTone = btn.getAttribute("data-current-tone");
                const misaId = Number(btn.getAttribute("data-misa-id"));
                const misaSongId = Number(
                    btn.getAttribute("data-misa-song-id"),
                );
                const token = document
                    .querySelector("main")
                    ?.getAttribute("data-token");
                const editToken = document
                    .querySelector("main")
                    ?.getAttribute("data-edit-token");

                const { value: newTone } = await Swal.fire({
                    title: "Cambiar Tono",
                    input: "text",
                    inputLabel: "Nuevo tono (ej: Do, Re, Mim)",
                    inputValue: currentTone || "",
                    showCancelButton: true,
                    confirmButtonColor: "#f97316",
                    cancelButtonColor: "#4b5563",
                    confirmButtonText: "Guardar",
                    background: "#1f2937",
                    color: "#fff",
                    inputValidator: (value) => {
                        if (!value) {
                            return "Debes escribir un tono";
                        }
                    },
                });

                if (newTone && newTone !== currentTone) {
                    showLoading("Actualizando...");
                    try {
                        const res = await updateMisaSong(
                            misaId,
                            misaSongId,
                            newTone,
                            token || undefined,
                            editToken || undefined,
                        );
                        if (res.success) {
                            window.location.reload();
                        } else {
                            showError(
                                "Error",
                                res.error || "No se pudo actualizar el tono.",
                            );
                        }
                    } catch (err) {
                        showError("Error", "Error de conexi√≥n.");
                    }
                }
            });
        });

        const buttons = document.querySelectorAll(".add-song-btn");
        buttons.forEach((btn) => {
            btn.addEventListener("click", () => {
                const momentId = btn.getAttribute("data-moment-id");
                if ((window as any).openAddSongModal) {
                    (window as any).openAddSongModal(momentId);
                } else {
                    showError(
                        "Error",
                        "El gestor de canciones no est√° cargado. Intenta recargar la p√°gina.",
                    );
                }
            });
        });

        const deleteButtons = document.querySelectorAll(
            'button[data-action="delete-song"]',
        );
        deleteButtons.forEach((btn) => {
            btn.addEventListener("click", async (e) => {
                e.preventDefault();

                const result = await showConfirm(
                    "¬øEliminar canci√≥n?",
                    "No podr√°s deshacer esta acci√≥n",
                    "S√≠, eliminar",
                );

                if (!result.isConfirmed) return;

                const misaId = Number(btn.getAttribute("data-misa-id"));
                const misaSongId = Number(
                    btn.getAttribute("data-misa-song-id"),
                );

                const token = document
                    .querySelector("main")
                    ?.getAttribute("data-token");
                const editToken = document
                    .querySelector("main")
                    ?.getAttribute("data-edit-token");

                if (misaId && misaSongId && (token || editToken)) {
                    // Mostrar loading
                    showLoading("Eliminando...");

                    try {
                        const res = await removeSongFromMisa(
                            misaId,
                            misaSongId,
                            token || undefined,
                            editToken || undefined,
                        );
                        if (res.success) {
                            window.location.reload();
                        } else {
                            showError(
                                "Error",
                                res.error || "Error al eliminar.",
                            );
                        }
                    } catch (error) {
                        showError("Error", "Error de conexi√≥n.");
                    }
                }
            });
        });

        const copyToClipboard = async (
            text: string,
            successTitle: string,
            successText: string,
        ) => {
            try {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                    showSuccessToast(successTitle, successText);
                } else {
                    throw new Error("Clipboard API not available");
                }
            } catch (err) {
                console.error("Error al copiar", err);
                showError(
                    "Error",
                    "No se pudo copiar el enlace. Intenta hacerlo manualmente.",
                );
            }
        };

        const copyShareLinkBtn = document.getElementById("copyShareLinkBtn");
        if (copyShareLinkBtn) {
            copyShareLinkBtn.addEventListener("click", () => {
                const shareToken =
                    copyShareLinkBtn.getAttribute("data-share-token");
                if (shareToken) {
                    const url = `${window.location.origin}${window.location.pathname}?share_token=${shareToken}`;
                    copyToClipboard(
                        url,
                        "¬°Enlace copiado!",
                        "Comp√°rtelo con quien quieras.",
                    );
                } else {
                    console.error("No share token found");
                    showError(
                        "Error",
                        "No se encontr√≥ el token para compartir.",
                    );
                }
            });
        }

        const copyEditorLinkBtn = document.getElementById("copyEditorLinkBtn");
        if (copyEditorLinkBtn) {
            copyEditorLinkBtn.addEventListener("click", () => {
                const editToken =
                    copyEditorLinkBtn.getAttribute("data-edit-token");
                console.log("Copy Editor Btn clicked. Token:", editToken);

                if (editToken) {
                    const url = `${window.location.origin}${window.location.pathname}?edit_token=${editToken}`;
                    copyToClipboard(
                        url,
                        "¬°Enlace de Editor copiado!",
                        "Ten cuidado con qui√©n lo compartes.",
                    );
                } else {
                    console.error("No edit token found on button");
                    showError("Error", "No se encontr√≥ el token de edici√≥n.");
                }
            });
        }

        // Edit Misa Logic
        const editMisaBtn = document.getElementById("editMisaBtn");
        const editMisaModal = document.getElementById("editMisaModal");
        const closeEditMisaModal =
            document.getElementById("closeEditMisaModal");
        const editMisaForm = document.getElementById(
            "editMisaForm",
        ) as HTMLFormElement;

        if (editMisaBtn && editMisaModal && closeEditMisaModal) {
            editMisaBtn.addEventListener("click", () => {
                editMisaModal.classList.remove("hidden");
            });

            closeEditMisaModal.addEventListener("click", () => {
                editMisaModal.classList.add("hidden");
            });

            editMisaModal.addEventListener("click", (e) => {
                if (e.target === editMisaModal) {
                    editMisaModal.classList.add("hidden");
                }
            });
        }

        if (editMisaForm) {
            editMisaForm.addEventListener("submit", async (e) => {
                e.preventDefault();
                const formData = new FormData(editMisaForm);
                const title = formData.get("title")?.toString() || "";
                const dateMisa = formData.get("dateMisa")?.toString() || "";
                const visibility = formData.get("visibility")?.toString() || "";
                const misaId = editMisaForm.getAttribute("data-misa-id");

                const token = document
                    .querySelector("main")
                    ?.getAttribute("data-token");
                const editToken = document
                    .querySelector("main")
                    ?.getAttribute("data-edit-token");

                if (!misaId) return;

                if (token || editToken) {
                    // Loading button state
                    const submitBtn = editMisaForm.querySelector(
                        "button[type='submit']",
                    );
                    const originalText = submitBtn
                        ? submitBtn.textContent
                        : "Guardar";

                    if (submitBtn) {
                        submitBtn.setAttribute("disabled", "true");
                        submitBtn.textContent = "Guardando...";
                    }

                    try {
                        console.log("Calling updateMisa...");
                        const res = await updateMisa(
                            parseInt(misaId),
                            title,
                            dateMisa,
                            visibility,
                            token || undefined,
                            editToken || undefined,
                        );
                        console.log("updateMisa result:", res);

                        if (res.success) {
                            console.log("Success, showing toast...");
                            await showSuccessToast(
                                "¬°Actualizado!",
                                "Los datos de la misa se han guardado",
                            );
                            console.log("Toast shown, reloading...");
                            window.location.reload();
                        } else {
                            showError(
                                "Error",
                                res.error || "Error al actualizar",
                            );

                            if (submitBtn) {
                                submitBtn.removeAttribute("disabled");
                                submitBtn.textContent = originalText;
                            }
                        }
                    } catch (error) {
                        console.error(error);
                        showError("Error", "Error de conexi√≥n");

                        if (submitBtn) {
                            submitBtn.removeAttribute("disabled");
                            submitBtn.textContent = originalText;
                        }
                    }
                }
            });
        }

        const deleteMisaBtn = document.getElementById("deleteMisaBtn");
        if (deleteMisaBtn) {
            deleteMisaBtn.addEventListener("click", async () => {
                const editMisaForm = document.getElementById(
                    "editMisaForm",
                ) as HTMLFormElement;
                const misaId = editMisaForm?.getAttribute("data-misa-id");
                const token = document
                    .querySelector("main")
                    ?.getAttribute("data-token");

                if (!misaId || !token) return;

                const confirmed = await showConfirm(
                    "¬øEliminar misa?",
                    "Esta acci√≥n no se puede deshacer.",
                    "S√≠, eliminar",
                );

                if (confirmed.isConfirmed) {
                    showLoading("Eliminando...");
                    try {
                        const res = await deleteMisa(parseInt(misaId), token);
                        if (res.success) {
                            await showSuccessToast(
                                "Misa eliminada",
                                undefined,
                                1500,
                            );
                            window.location.href = "/misas";
                        } else {
                            showError(
                                "Error",
                                res.error || "Error al eliminar",
                            );
                        }
                    } catch (e) {
                        showError("Error", "Error de conexi√≥n");
                    }
                }
            });
        }
    });
</script>

<!-- Edit Misa Modal -->
<div
    id="editMisaModal"
    class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"
>
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg border border-gray-200 dark:border-gray-700 mx-4 overflow-hidden"
    >
        <div
            class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"
        >
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100">
                Editar Misa
            </h3>
            <button
                id="closeEditMisaModal"
                class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors"
                >‚úï</button
            >
        </div>
        <form id="editMisaForm" class="p-6 space-y-4" data-misa-id={id}>
            <div>
                <label
                    class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                    >T√≠tulo</label
                >
                <input
                    type="text"
                    name="title"
                    value={misa?.title}
                    required
                    class="w-full bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-accent-main outline-none"
                />
            </div>
            <div>
                <label
                    class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                    >Fecha</label
                >
                <input
                    type="datetime-local"
                    name="dateMisa"
                    value={misa?.dateMisa
                        ? new Date(misa.dateMisa).toISOString().slice(0, 16)
                        : ""}
                    required
                    class="w-full bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-accent-main outline-none"
                />
            </div>
            <div>
                <label
                    class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                    >Visibilidad</label
                >
                <select
                    name="visibility"
                    id="visibilitySelect"
                    class="w-full bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-accent-main outline-none"
                >
                    <option
                        value="PUBLIC"
                        selected={misa?.visibility === "PUBLIC"}>P√∫blica</option
                    >
                    <option
                        value="PRIVATE"
                        selected={misa?.visibility === "PRIVATE"}
                        >Privada (Solo t√∫ y enlace)</option
                    >
                </select>
            </div>
            <div class="flex justify-between pt-4">
                <button
                    type="button"
                    id="deleteMisaBtn"
                    class="bg-red-100 text-red-600 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50 font-bold py-2 px-6 rounded-lg transition-colors"
                >
                    Eliminar Misa
                </button>
                <button
                    type="submit"
                    class="bg-accent-main hover:bg-accent-main/90 text-white font-bold py-2 px-6 rounded-lg transition-transform transform active:scale-95"
                >
                    Guardar Cambios
                </button>
            </div>
        </form>
    </div>
</div>
