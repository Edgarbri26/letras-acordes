---
const { class: className } = Astro.props;
---

<form
    id="global-search-form"
    class={`flex-1 max-w-xl mx-4 ${className || ""}`}
    action="/search/all"
>
    <div class="relative flex justify-center items-center">
        <input
            id="global-search-input"
            name="q"
            class="w-full bg-bg-main border border-white/10 rounded-full py-2 px-4 pl-10 text-text-main focus:outline-none focus:border-accent-main transition-colors"
            type="search"
            placeholder="¿Qué quieres tocar y cantar hoy?"
            autocomplete="off"
        />
        <button
            type="submit"
            class="absolute left-3 top-1/2 -translate-y-1/2 p-0 border-none bg-transparent cursor-pointer text-gray-500 hover:text-accent-main transition-colors"
            aria-label="Buscar"
        >
            <i
                class="fa-solid fa-magnifying-glass h-5 w-5 flex items-center justify-center"
            ></i>
        </button>
    </div>
</form>

<script>
    document.addEventListener("astro:page-load", () => {
        const searchForm = document.getElementById(
            "global-search-form",
        ) as HTMLFormElement;
        const searchInput = document.getElementById(
            "global-search-input",
        ) as HTMLInputElement;

        if (searchForm && searchInput) {
            searchForm.addEventListener("submit", (e) => {
                e.preventDefault();
                const query = searchInput.value.trim();
                if (query) {
                    window.location.href = `/search/${encodeURIComponent(query)}`;
                } else {
                    window.location.href = `/search/all`;
                }
            });
        }
    });
</script>
